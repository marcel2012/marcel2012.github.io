<!DOCTYPE html>
<html>
  <head>
   	<title>Generator drzew online - generator grafów online</title>
	<meta name="author" content="marcel2012 @ GITHUB.COM">
	<meta name="keywords" content="online,grafy,drzewa,algorytmy,algorytmika,dfs,bfs,drzewo,n,m,n-1">
	<meta name="description" content="Generator drzew online. Generator grafów online. Euler. Hamilton. Przeszukiwanie w głąb.">
	<meta charset="UTF-8">
	<style>
		body,html
		{
			width:100%;
			height:100%;
			margin:0;
			padding:0;
			border:0;
			background:linear-gradient(#81AD3E,#81AD3E);
			color:#fff;
			font-size:15px;
		}
		input[type=number],input[type=submit]
		{
			background:rgba(255,255,255,0.1);
			width:200px;
			outline:none;
			border-width:0;
			color:#fff;
			padding:2px 15px;
		}
		input[type=submit]
		{
			margin-left:100px;
		}
		.opcje
		{
			background:rgba(0,0,0,0.9);
			width:90%;
			padding:2% 5%;
		}
		.opcje td
		{
			width:200px;
		}
		.dana
		{
			width:100%;
		}
		canvas
		{
			background:#fff;
			border: 1px solid #000;
			margin:auto;
			position:relative;
			display:block;
		}
		#dane
		{
			background:#fff;
			border: 1px solid #000;
			width:880px;
			min-height:80px;
			overflow-y:auto;
			padding:10px;
			color:#000;
			margin:auto;
		}
		.dane
		{
			background:#fff;
			border: 1px solid #000;
			width:880px;
			min-height:150px;
			overflow-y:auto;
			padding:10px;
			color:#000;
			margin:auto;
		}
		textarea
		{
			display:block;
			resize:vertical;
		}
		#copy1,#copy2,#copy3
		{
			background:#25281e;
			border: 1px solid #000;
			width:880px;
			overflow-y:auto;
			padding:10px;
			color:#fff;
			margin:auto;
			display:block;
		}
	</style>
	<script>
		var c_width;
		var c_height;
		window.onload=function()
		{
			c_width=window.innerWidth*0.95;
			c_height=window.innerHeight-200;;
			document.getElementById("canvas").style.width=c_width+"px";
			document.getElementById("canvas").style.height=c_height+"px";
			document.getElementById("canvas").width=c_width;
			document.getElementById("canvas").height=c_height;
			document.getElementById("dane").style.width=c_width-20+"px";
			document.getElementById("copy1").style.width=c_width+2+"px";
			document.getElementById("copy2").style.width=c_width+2+"px";
			document.getElementById("copy3").style.width=c_width+2+"px";
			document.getElementsByClassName("dane")[0].style.width=c_width-20+"px";
			rysuj_drzewo(drzewo(document.getElementById('n').value,drzewo(document.getElementById('n').value)),true);
		}
		function R(min,max)
		{
			return Math.min(parseInt(Math.random()*(max-min+1))+min,max);
		}
		function drzewo(n /*liczba wierzchołków*/,
						d /*maksymalna liczba dzieci*/)
		{
			wierzcholek=[];
			wierzcholek[0]={};
			wierzcholek[0].dziecko=[];
			wierzcholek[0].rodzic=0;
			wierzcholek[0].lewa=0;
			for(i=1;i<n;i++)
			{
				wierzcholek[i]={};
				wierzcholek[i].dziecko=[];
				do
				{
					r=R(0,i-1);
				}
				while(wierzcholek[r].dziecko.length>=d);
				wierzcholek[i].rodzic=r;
				wierzcholek[r].dziecko[wierzcholek[r].dziecko.length]=i;
			}
			return wierzcholek;
		}
		function graf(n /*liczba wierzchołków*/,
						m /*liczba krawędzi*/)
		{
			wierzcholek=[];
			for(i=0;i<n;i++)
			{
				wierzcholek[i]={};
				wierzcholek[i].sasiad=[];
				wierzcholek[i].odwiedzony=0;
			}
			for(i=0;i<m;i++)
			{
				do
				{
					r1=R(0,n-1);
					r2=R(0,n-1);
				}
				while(wierzcholek[r1].sasiad.indexOf(r2)!=-1 || r1==r2);
				wierzcholek[r1].sasiad[wierzcholek[r1].sasiad.length]=r2;
				wierzcholek[r2].sasiad[wierzcholek[r2].sasiad.length]=r1;
			}
			return wierzcholek;
		}
		function generuj_drzewo(typ /*0 losowe, 1 binarne*/,
								n /*liczba wierzchołków*/)
		{
			switch (typ)
			{
				case 0:
					return drzewo(n,n);
				break;
				case 1:
					return drzewo(n,2);
				break;
			}
			
		}
		function generuj_graf(typ /*0 losowy, 1 pełny*/,
								n /*liczba wierzchołków*/,
								spojne /*sprawdź spójność*/)
		{
			switch (typ)
			{
				case 0:
					return graf(n,n);
				break;
				case 1:
					return graf(n,n*(n-1)/2);
				break;
			}
			
		}
		function szerokosc_dfs(wierzcholek,start)
		{
			wierzcholek[start].szerokosc=0;
			wierzcholek[start].i=0;
			for(;wierzcholek[start].i<wierzcholek[start].dziecko.length;wierzcholek[start].i++)
				wierzcholek[start].szerokosc+=szerokosc_dfs(wierzcholek,wierzcholek[start].dziecko[wierzcholek[start].i]);
			if(wierzcholek[start].szerokosc==0)
				wierzcholek[start].szerokosc++;
			return wierzcholek[start].szerokosc;
		}
		function drzewo_polozenie_dfs(wierzcholek,start,szerokosc,glebokosc,poziom)
		{
			wierzcholek[start].lewa=wierzcholek[wierzcholek[start].rodzic].lewa;
			wierzcholek[start].i=0;
			wierzcholek[start].y=poziom;
			wierzcholek[start].x=wierzcholek[start].lewa+wierzcholek[start].szerokosc/2;
			for(;wierzcholek[start].i<wierzcholek[start].dziecko.length;wierzcholek[start].i++)
			{
				drzewo_polozenie_dfs(wierzcholek,wierzcholek[start].dziecko[wierzcholek[start].i],szerokosc,glebokosc,poziom+1);
				wierzcholek[start].lewa+=wierzcholek[wierzcholek[start].dziecko[wierzcholek[start].i]].szerokosc;
			}
		}
		function glebokosc_dfs(wierzcholek,start)
		{
			wierzcholek[start].glebokosc=0;
			wierzcholek[start].i=0;
			for(;wierzcholek[start].i<wierzcholek[start].dziecko.length;wierzcholek[start].i++)
				wierzcholek[start].glebokosc=Math.max(wierzcholek[start].glebokosc,glebokosc_dfs(wierzcholek,wierzcholek[start].dziecko[wierzcholek[start].i]));
			return wierzcholek[start].glebokosc+1;
		}
		function spojny_dfs(wierzcholek,start)
		{
			wierzcholek[start].odwiedzony=1;
			wierzcholek[start].i=0;
			for(;wierzcholek[start].i<wierzcholek[start].sasiad.length;wierzcholek[start].i++)
				if(wierzcholek[wierzcholek[start].sasiad[wierzcholek[start].i]].odwiedzony==0)
					spojny_dfs(wierzcholek,wierzcholek[start].sasiad[wierzcholek[start].i]);
		}
		function graf_spojny(wierzcholek)
		{
			spojny_dfs(wierzcholek,0);
			for(i=0;i<wierzcholek.length;i++)
				if(wierzcholek[i].odwiedzony==0)
					return false;
			return true;
		}
		function rysuj_drzewo(wierzcholek,wypisz)
		{
			if(wypisz)
			{
				document.getElementById("dane").value=document.getElementById('n').value;
				for(i=1;i<wierzcholek.length;i++)
					document.getElementById("dane").value+="\n"+wierzcholek[i].rodzic;
			}
			szerokosc=szerokosc_dfs(wierzcholek,0);
			glebokosc=glebokosc_dfs(wierzcholek,0);
			drzewo_polozenie_dfs(wierzcholek,0,szerokosc,glebokosc,1);
			ctx=document.getElementById("canvas").getContext("2d");
			ctx.clearRect(0,0,c_width,c_height);
			ctx.font=(wierzcholek.length<50?22:"bold 12")+"px Consolas";
			for(i=1;i<wierzcholek.length;i++)
			{
				ctx.beginPath();
				ctx.strokeStyle="black";
				ctx.lineWidth="1";
				ctx.moveTo(wierzcholek[i].x*c_width/szerokosc,wierzcholek[i].y*c_height/(glebokosc+1));
				ctx.lineTo(wierzcholek[wierzcholek[i].rodzic].x*c_width/szerokosc,wierzcholek[wierzcholek[i].rodzic].y*c_height/(glebokosc+1));
				ctx.stroke();
			}
			for(i=0;i<wierzcholek.length;i++)
			{
				ctx.beginPath();
				ctx.arc(wierzcholek[i].x*c_width/szerokosc,wierzcholek[i].y*c_height/(glebokosc+1),(wierzcholek.length<50?20:10), 0, 2 * Math.PI, false);
				ctx.fillStyle = '#fff';
				ctx.fill();
				ctx.lineWidth = 2;
				ctx.strokeStyle = '#000';
				ctx.stroke(); 
				ctx.fillStyle='#000';
				ctx.textAlign="center";
				ctx.fillText(i,wierzcholek[i].x*c_width/szerokosc,wierzcholek[i].y*c_height/(glebokosc+1)+(wierzcholek.length<50?6:3));
			}
		}
		function rysuj_graf(wierzcholek,wypisz)
		{
			if(wypisz)
			{
				document.getElementById("dane").value=document.getElementById('graf_n').value+" "+document.getElementById('graf_m').value;
				for(i=0;i<wierzcholek.length;i++)
					for(j=0;j<wierzcholek[i].sasiad.length;j++)
						if(wierzcholek[i].sasiad[j]>i)
							document.getElementById("dane").value+="\n"+wierzcholek[i].sasiad[j]+" "+i;
			}
			ctx=document.getElementById("canvas").getContext("2d");
			ctx.clearRect(0,0,c_width,c_height);
			ctx.font=(wierzcholek.length<20?22:"bold 12")+"px Consolas";
			n=document.getElementById('graf_n').value;
			for(i=0;i<wierzcholek.length;i++)
				for(j=0;j<wierzcholek[i].sasiad.length;j++)
					if(wierzcholek[i].sasiad[j]>i)
					{
						ctx.beginPath();
						ctx.strokeStyle="black";
						ctx.lineWidth="1";
						ctx.moveTo(c_width/2.2*Math.sin(Math.PI*2*i/n)+c_width/2,c_height/-2.2*Math.cos(Math.PI*2*i/n)+c_height/2);
						ctx.lineTo(c_width/2.2*Math.sin(Math.PI*2*wierzcholek[i].sasiad[j]/n)+c_width/2,c_height/-2.2*Math.cos(Math.PI*2*wierzcholek[i].sasiad[j]/n)+c_height/2);
						ctx.stroke();
					}
			for(i=0;i<wierzcholek.length;i++)
			{
				ctx.beginPath();
				ctx.arc(c_width/2.2*Math.sin(Math.PI*2*i/n)+c_width/2,c_height/-2.2*Math.cos(Math.PI*2*i/n)+c_height/2,(wierzcholek.length<20?20:10), 0, 2 * Math.PI, false);
				ctx.fillStyle = '#fff';
				ctx.fill();
				ctx.lineWidth = 2;
				ctx.strokeStyle = '#000';
				ctx.stroke(); 
				ctx.fillStyle='#000';
				ctx.textAlign="center";
				ctx.fillText(i,c_width/2.2*Math.sin(Math.PI*2*i/n)+c_width/2,c_height/-2.2*Math.cos(Math.PI*2*i/n)+c_height/2+(wierzcholek.length<20?6:3));
			}
		}
		function czytaj_graf(dane)
		{
  			dane=dane.replace(/ /g,'_');
  			dane=dane.replace(/\n/g,'_');
  			dane=dane.replace(/____/g,'_');
  			dane=dane.replace(/___/g,'_');
  			dane=dane.replace(/__/g,'_');
  			i=0;
  			n=parseInt(dane.substr(i));
	  		while(dane[i]!='_')
	  			i++;
	  		i++;
  			m=parseInt(dane.substr(i));
	  		while(dane[i]!='_')
	  			i++;
	  		i++;
  			document.getElementById('graf_n').value=n;
  			document.getElementById('graf_m').value=m;
	  		wierzcholek=[];
			for(j=0;j<n;j++)
			{
				wierzcholek[j]={};
				wierzcholek[j].sasiad=[];
				wierzcholek[j].odwiedzony=0;
			}
  			for(j=0;j<m;j++)
  			{
  				if(i>=dane.length)
  				{
  					alert('Za mało danych');
  					return false;
  				}
  				r1=parseInt(dane.substr(i));
		  		while(dane[i]!='_')
		  			i++;
		  		i++;
	  			r2=parseInt(dane.substr(i));
		  		while(dane[i]!='_' && i<dane.length)
		  			i++;
		  		i++;
  				if(r1==r2)
  				{
  					alert('Zła krawędź - pętla');
  					return false;
  				}
  				if(wierzcholek[r1].sasiad.indexOf(r2)!=-1)
  				{
  					alert('Zła krawędź - zdublowana krawędź');
  					return false;
  				}
				wierzcholek[r1].sasiad[wierzcholek[r1].sasiad.length]=r2;
				wierzcholek[r2].sasiad[wierzcholek[r2].sasiad.length]=r1;
  			}
			rysuj_graf(wierzcholek,false);
		}
		function czytaj_drzewo(dane)
		{
  			dane=dane.replace(/ /g,'_');
  			dane=dane.replace(/\n/g,'_');
  			dane=dane.replace(/____/g,'_');
  			dane=dane.replace(/___/g,'_');
  			dane=dane.replace(/__/g,'_');
  			i=0;
  			n=parseInt(dane.substr(i));
	  		while(dane[i]!='_')
	  			i++;
	  		i++;
  			document.getElementById('n').value=n;
  			wierzcholek=[];
			wierzcholek[0]={};
			wierzcholek[0].dziecko=[];
			wierzcholek[0].rodzic=0;
			wierzcholek[0].lewa=0;
			for(j=1;j<n;j++)
			{
				wierzcholek[j]={};
				wierzcholek[j].dziecko=[];
  				if(i>=dane.length)
  				{
  					alert('Za mało danych');
  					return false;
  				}
  				r=parseInt(dane.substr(i));
		  		while(dane[i]!='_' && i<dane.length)
		  			i++;
		  		i++;
  				if(j==r)
  				{
  					alert('Błąd danych - rodzicem dla '+j+" nie może być "+r);
  					return false;
  				}
				wierzcholek[j].rodzic=r;
				wierzcholek[r].dziecko[wierzcholek[r].dziecko.length]=j;
			}
			rysuj_drzewo(wierzcholek,false);
		}
	</script>
  </head>
  <body>
  	<div class="opcje">
	  	<form style="float:left;" onsubmit="
	  		if(document.getElementById('binarne').checked)
		  		rysuj_drzewo(
		  			drzewo(document.getElementById('n').value,
		  			2),
		  			true
		  		);
	  		else
		  		rysuj_drzewo(
		  			drzewo(document.getElementById('n').value,
		  				document.getElementById('n').value),
		  			true
		  		);
	  		return false;">
	  		<table>
	  			<tbody>
	  				<tr>
	  					<td>Ilość wierzchołków</td>
	  					<td><input id="n" type="number" min="1" max="100" value="8"/></td>
	  				</tr>
	  			</tbody>
	  		</table>
	  		<label>
	  			<input type="checkbox" id="binarne"/>
	  			Binarne
	  		</label>
	  		<br>
		  	<input type="submit" value="Generuj drzewo"/>
	  	</form>
	  	<form style="display:inline-block;" onsubmit="
	  		if(document.getElementById('spojny').checked)
	  			if(document.getElementById('graf_m').value<document.getElementById('graf_n').value-1)
	  			{
	  				alert('Niespełniony warunek m >= n-1');
	  				return false;
	  			}
	  		if(document.getElementById('graf_m').value*2>document.getElementById('graf_n').value*(document.getElementById('graf_n').value-1))
	  		{
	  			alert('Niespełniony warunek m <= n*(n-1)/2');
	  			return false;
	  		}
	  		do
	  		{
	  			correct=true;
	  			wierzcholek=graf(document.getElementById('graf_n').value,
		  				document.getElementById('graf_m').value);
		  		if(document.getElementById('spojny').checked && !graf_spojny(wierzcholek))
		  			correct=false;
		  	}
	  		while(!correct);
	  		rysuj_graf(wierzcholek,true);
	  		return false;">
	  		<table>
	  			<tbody>
	  				<tr>
	  					<td>Ilość wierzchołków</td>
	  					<td><input id="graf_n" type="number" min="1" max="50" value="8"/></td>
	  				</tr>
	  				<tr>
	  					<td>Ilość krewedzi</td>
	  					<td><input id="graf_m" type="number" min="1" max="1225" value="16"/></td>
	  				</tr>
	  			</tbody>
	  		</table>
	  		<label>
	  			<input type="checkbox" id="spojny" checked/>
	  			Spójny
	  		</label>
	  		<br>
		  	<input type="submit" value="Generuj graf"/>
	  	</form>
  	</div>
  	<div class="dana">
  		<br>
  		<canvas id="canvas"></canvas>
  		<textarea id="dane">
  		</textarea>
  		<input id="copy1" onclick="document.getElementById('dane').select();document.execCommand('copy');return false;" type="submit" value="Skopiuj dane"/>
  		<input id="copy2" onclick="czytaj_graf(document.getElementById('dane').value);return false;" type="submit" value="Rysuj graf z danych"/>
  		<input id="copy3" onclick="czytaj_drzewo(document.getElementById('dane').value);return false;" type="submit" value="Rysuj drzewo z danych"/>
  		<div class="dane">
  			<h3>Drzewo</h3>
  			Dane:
  			n - liczba wierzchołków<br>
  			<br>
  			kolejne n-1 wierszy to informacje o rodzicach<br>
  			<br>
  			w i-tym wierszu znajduje się rodzic wierzchołka o numerze i <nobr>(numeracja wierzchołków od 0 do n-1)</nobr><br>
  			<br>
  			wierzchołek 0 jest korzeniem
  			<h3>Graf</h3>
  			Dane:
  			n,m - liczba wierzchołków, liczba krawędzi<br>
  			<br>
  			kolejne m wierszy to a,b między którymi istnieje krawędź
  		</div>
  	</div>
  </body>
</html>
